{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Ketik/vscodeProjects/may-codeditIDE/may-codeditor3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:/Users/Ketik/vscodeProjects/may-codeditIDE/may-codeditor3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/Ketik/vscodeProjects/may-codeditIDE/may-codeditor3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import io from\"socket.io-client\";import AceEditor from\"react-ace\";import\"ace-builds/src-noconflict/mode-javascript\";import\"ace-builds/src-noconflict/theme-monokai\";import\"ace-builds/src-noconflict/ext-language_tools\";import\"ace-builds/src-noconflict/snippets/javascript\";import Members from'../Members/Members';import Notifications from'../Notifications/Notifications';import InfoBar from'../InfoBar/InfoBar';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var socket;var Chat=function Chat(data){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),room=_useState4[0],setRoom=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),notifications=_useState8[0],setNotifications=_useState8[1];var _useState9=useState({error:false,msg:''}),_useState10=_slicedToArray(_useState9,2),flag=_useState10[0],setFlag=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),code=_useState12[0],setCode=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),lastedit=_useState14[0],setLastEdit=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),loading=_useState16[0],setLoading=_useState16[1];var ENDPOINT='https://may-codeditor3.herokuapp.com/';//'http://localhost:5000/';\n//Component did mount, destructure data/args from reate and join room component\n//Do socket.io to create and join, accordingly\nuseEffect(function(){var name=data.name,room=data.room,create=data.create;socket=io(ENDPOINT);setRoom(room);setName(name);if(create){//perform create function specified in socket.io for args user and error\nsocket.emit('create',{name:name,room:room},function(error){setLoading(false);if(error){setFlag(_objectSpread(_objectSpread({},flag),{},{error:true,msg:error}));}});}else{socket.emit('join',{name:name,room:room},function(error){setLoading(false);if(error){setFlag(_objectSpread(_objectSpread({},flag),{},{error:true,msg:error}));}});}},[ENDPOINT,data]);//if endpoint is  reloaded, do useEffect \n//Concatenation; set notification and spread in the array, also add the notification from socket.io \nuseEffect(function(){socket.on('notification',function(notification){setNotifications(function(notifications){return[].concat(_toConsumableArray(notifications),[notification]);});});//perform the emit codeMessage from our socket.io, the we are setting code and lastedit\nsocket.on('codeMessage',function(message){setCode(message.text);setLastEdit(message.user);});//perform roomData function as in socket.io and destructure data to select only 'users' and set into the users array\nsocket.on(\"roomData\",function(_ref){var users=_ref.users;setUsers(users);});},[]);//responsible for passing change in contents of editor; onChange\nvar validateInput=function validateInput(value){socket.emit('sendCode',value);};if(flag.error==true){setTimeout(function(){window.location.href='/';},1000);}var editor=function editor(){return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col\",style:{marginTop:20},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card p-3 logincard\",style:{width:'35rem'},children:[/*#__PURE__*/_jsx(InfoBar,{room:room,lastedit:lastedit}),/*#__PURE__*/_jsx(AceEditor,{mode:\"javascript\",theme:\"monokai\",value:code,onChange:function onChange(value){return validateInput(value);}//onChange it should do validateInput function(which is to emit sendCode with our aceEditor value)\n,style:{width:'100%'},setOptions:{enableLiveAutocompletion:true}})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col\",style:{marginTop:20,marginLeft:'100px'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card p-3\",children:[/*#__PURE__*/_jsx(\"h5\",{style:{textAlign:'center'},children:\"Notifications\"}),/*#__PURE__*/_jsx(\"div\",{className:\"scroll\",children:/*#__PURE__*/_jsx(Notifications,{notifications:notifications,name:name})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card p-3\",style:{marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"h5\",{style:{textAlign:'center'},children:\"Members\"}),/*#__PURE__*/_jsx(\"div\",{className:\"scroll\",children:/*#__PURE__*/_jsx(Members,{users:users})}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"a\",{className:\"btn btn-danger\",href:\"/\",children:\"Leave\"})]})]})]})});};var errorOccured=function errorOccured(){return/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center',alignItems:'center',height:'100vh'},children:/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-danger\",role:\"alert\",style:{width:'500px',marginTop:'20px'},children:[/*#__PURE__*/_jsx(\"h4\",{className:\"alert-heading\",children:\"Error!\"}),/*#__PURE__*/_jsx(\"p\",{children:\"An error occured, try again.\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-0\",children:[flag.msg,\".\"]})]})});};var loadingScreen=function loadingScreen(){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{style:{textAlign:\"center\",marginTop:'300px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})})})});};return/*#__PURE__*/_jsx(_Fragment,{children:loading===true?loadingScreen():flag.error===true?errorOccured():editor()});};export default Chat;","map":{"version":3,"sources":["C:/Users/Ketik/vscodeProjects/may-codeditIDE/may-codeditor3/src/components/Chat/Chat.js"],"names":["React","useState","useEffect","io","AceEditor","Members","Notifications","InfoBar","socket","Chat","data","name","setName","room","setRoom","users","setUsers","notifications","setNotifications","error","msg","flag","setFlag","code","setCode","lastedit","setLastEdit","loading","setLoading","ENDPOINT","create","emit","on","notification","message","text","user","validateInput","value","setTimeout","window","location","href","editor","marginTop","width","enableLiveAutocompletion","marginLeft","textAlign","errorOccured","display","justifyContent","alignItems","height","loadingScreen"],"mappings":"6hBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,EAAP,KAAe,kBAAf,CACA,MAAOC,CAAAA,SAAP,KAAsB,WAAtB,CACA,MAAO,2CAAP,CACA,MAAO,yCAAP,CACA,MAAO,8CAAP,CACA,MAAO,+CAAP,CAEA,MAAOC,CAAAA,OAAP,KAAoB,oBAApB,CACA,MAAOC,CAAAA,aAAP,KAA0B,gCAA1B,CACA,MAAOC,CAAAA,OAAP,KAAoB,oBAApB,C,6IAEA,GAAIC,CAAAA,MAAJ,CAGA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,CAACC,IAAD,CAAU,CACnB,cAAwBT,QAAQ,CAAC,EAAD,CAAhC,wCAAOU,IAAP,eAAaC,OAAb,eACA,eAAwBX,QAAQ,CAAC,EAAD,CAAhC,yCAAOY,IAAP,eAAaC,OAAb,eACA,eAA0Bb,QAAQ,CAAC,EAAD,CAAlC,yCAAOc,KAAP,eAAcC,QAAd,eACA,eAA0Cf,QAAQ,CAAC,EAAD,CAAlD,yCAAOgB,aAAP,eAAsBC,gBAAtB,eACA,eAAuBjB,QAAQ,CAAC,CAACkB,KAAK,CAAE,KAAR,CAAeC,GAAG,CAAE,EAApB,CAAD,CAA/B,0CAAOC,IAAP,gBAAaC,OAAb,gBACA,gBAAwBrB,QAAQ,CAAC,EAAD,CAAhC,2CAAOsB,IAAP,gBAAaC,OAAb,gBACA,gBAAgCvB,QAAQ,CAAC,EAAD,CAAxC,2CAAOwB,QAAP,gBAAiBC,WAAjB,gBACA,gBAA8BzB,QAAQ,CAAC,IAAD,CAAtC,2CAAO0B,OAAP,gBAAgBC,UAAhB,gBACA,GAAMC,CAAAA,QAAQ,CAAI,uCAAlB,CAA0D;AAE1D;AACA;AAEA3B,SAAS,CAAC,UAAM,CACZ,GAAOS,CAAAA,IAAP,CAA6BD,IAA7B,CAAOC,IAAP,CAAaE,IAAb,CAA6BH,IAA7B,CAAaG,IAAb,CAAmBiB,MAAnB,CAA6BpB,IAA7B,CAAmBoB,MAAnB,CAEAtB,MAAM,CAAGL,EAAE,CAAC0B,QAAD,CAAX,CAEAf,OAAO,CAACD,IAAD,CAAP,CACAD,OAAO,CAACD,IAAD,CAAP,CAEA,GAAGmB,MAAH,CAAU,CACN;AACAtB,MAAM,CAACuB,IAAP,CAAY,QAAZ,CAAsB,CAAEpB,IAAI,CAAJA,IAAF,CAAQE,IAAI,CAAJA,IAAR,CAAtB,CAAsC,SAACM,KAAD,CAAW,CAC7CS,UAAU,CAAC,KAAD,CAAV,CACA,GAAGT,KAAH,CAAU,CACNG,OAAO,gCAAKD,IAAL,MAAWF,KAAK,CAAE,IAAlB,CAAwBC,GAAG,CAAED,KAA7B,GAAP,CACH,CACJ,CALD,EAMH,CARD,IAUI,CACAX,MAAM,CAACuB,IAAP,CAAY,MAAZ,CAAoB,CAAEpB,IAAI,CAAJA,IAAF,CAAQE,IAAI,CAAJA,IAAR,CAApB,CAAoC,SAACM,KAAD,CAAW,CAC3CS,UAAU,CAAC,KAAD,CAAV,CACA,GAAGT,KAAH,CAAU,CACRG,OAAO,gCAAKD,IAAL,MAAWF,KAAK,CAAE,IAAlB,CAAwBC,GAAG,CAAED,KAA7B,GAAP,CACD,CACJ,CALD,EAMH,CAEJ,CA3BQ,CA2BN,CAACU,QAAD,CAAWnB,IAAX,CA3BM,CAAT,CA2BwB;AAExB;AACAR,SAAS,CAAC,UAAM,CACZM,MAAM,CAACwB,EAAP,CAAU,cAAV,CAA0B,SAAAC,YAAY,CAAI,CACtCf,gBAAgB,CAAC,SAAAD,aAAa,qCAASA,aAAT,GAAwBgB,YAAxB,IAAd,CAAhB,CACH,CAFD,EAIA;AACAzB,MAAM,CAACwB,EAAP,CAAU,aAAV,CAAyB,SAAAE,OAAO,CAAI,CAChCV,OAAO,CAACU,OAAO,CAACC,IAAT,CAAP,CACAT,WAAW,CAACQ,OAAO,CAACE,IAAT,CAAX,CACH,CAHD,EAKA;AACA5B,MAAM,CAACwB,EAAP,CAAU,UAAV,CAAsB,cAAa,IAAXjB,CAAAA,KAAW,MAAXA,KAAW,CAC/BC,QAAQ,CAACD,KAAD,CAAR,CACH,CAFD,EAGH,CAfQ,CAeN,EAfM,CAAT,CAiBA;AACA,GAAMsB,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,KAAD,CAAW,CAC7B9B,MAAM,CAACuB,IAAP,CAAY,UAAZ,CAAwBO,KAAxB,EACH,CAFD,CAIA,GAAGjB,IAAI,CAACF,KAAL,EAAc,IAAjB,CAAsB,CAClBoB,UAAU,CAAC,UAAK,CACZC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqB,GAArB,CACH,CAFS,CAEP,IAFO,CAAV,CAGH,CAID,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACjB,mBACA,YAAK,SAAS,CAAC,WAAf,uBACI,aAAK,KAAK,CAAC,KAAX,wBACI,YAAK,SAAS,CAAC,KAAf,CAAqB,KAAK,CAAE,CAACC,SAAS,CAAE,EAAZ,CAA5B,uBACI,aAAK,SAAS,CAAC,oBAAf,CAAoC,KAAK,CAAE,CAACC,KAAK,CAAE,OAAR,CAA3C,wBACI,KAAC,OAAD,EAAS,IAAI,CAAEhC,IAAf,CAAqB,QAAQ,CAAEY,QAA/B,EADJ,cAEI,KAAC,SAAD,EAAW,IAAI,CAAC,YAAhB,CAA6B,KAAK,CAAC,SAAnC,CAA6C,KAAK,CAAEF,IAApD,CACA,QAAQ,CAAE,kBAACe,KAAD,QAAWD,CAAAA,aAAa,CAACC,KAAD,CAAxB,EAAiC;AAD3C,CAEA,KAAK,CAAE,CAACO,KAAK,CAAE,MAAR,CAFP,CAGI,UAAU,CAAE,CACRC,wBAAwB,CAAE,IADlB,CAHhB,EAFJ,GADJ,EADJ,cAaI,aAAK,SAAS,CAAC,KAAf,CAAqB,KAAK,CAAE,CAACF,SAAS,CAAE,EAAZ,CAAgBG,UAAU,CAAE,OAA5B,CAA5B,wBACI,aAAK,SAAS,CAAC,UAAf,wBACI,WAAI,KAAK,CAAE,CAACC,SAAS,CAAE,QAAZ,CAAX,2BADJ,cAGI,YAAK,SAAS,CAAC,QAAf,uBACI,KAAC,aAAD,EAAe,aAAa,CAAE/B,aAA9B,CAA6C,IAAI,CAAEN,IAAnD,EADJ,EAHJ,GADJ,cAQI,aAAK,SAAS,CAAC,UAAf,CAA0B,KAAK,CAAE,CAACiC,SAAS,CAAE,MAAZ,CAAjC,wBACI,WAAI,KAAK,CAAE,CAACI,SAAS,CAAE,QAAZ,CAAX,qBADJ,cAEI,YAAK,SAAS,CAAC,QAAf,uBACI,KAAC,OAAD,EAAS,KAAK,CAAEjC,KAAhB,EADJ,EAFJ,cAKI,aALJ,cAKS,aALT,cAMI,UAAG,SAAS,CAAC,gBAAb,CAA8B,IAAI,CAAC,GAAnC,mBANJ,GARJ,GAbJ,GADJ,EADA,CAmCH,CApCD,CAsCA,GAAMkC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvB,mBACI,YAAK,KAAK,CAAE,CAACC,OAAO,CAAE,MAAV,CAAmBC,cAAc,CAAC,QAAlC,CAA4CC,UAAU,CAAC,QAAvD,CAAiEC,MAAM,CAAE,OAAzE,CAAZ,uBACI,aAAK,SAAS,CAAC,oBAAf,CAAoC,IAAI,CAAC,OAAzC,CAAiD,KAAK,CAAE,CAACR,KAAK,CAAE,OAAR,CAAiBD,SAAS,CAAE,MAA5B,CAAxD,wBACI,WAAI,SAAS,CAAC,eAAd,oBADJ,cAEI,mDAFJ,cAGI,aAHJ,cAII,WAAG,SAAS,CAAC,MAAb,WAAqBvB,IAAI,CAACD,GAA1B,OAJJ,GADJ,EADJ,CAUH,CAXD,CAaA,GAAMkC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CACxB,mBACI,kCACI,WAAI,KAAK,CAAE,CAACN,SAAS,CAAE,QAAZ,CAAsBJ,SAAS,CAAE,OAAjC,CAAX,uBACI,YAAK,SAAS,CAAC,gBAAf,CAAgC,IAAI,CAAC,QAArC,uBACI,aAAM,SAAS,CAAC,iBAAhB,wBADJ,EADJ,EADJ,EADJ,CASH,CAVD,CAaA,mBACI,yBAAIjB,OAAO,GAAK,IAAZ,CAAmB2B,aAAa,EAAhC,CAAqCjC,IAAI,CAACF,KAAL,GAAe,IAAf,CAAsB8B,YAAY,EAAlC,CAAuCN,MAAM,EAAtF,EADJ,CAGH,CA7ID,CAgJA,cAAelC,CAAAA,IAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport io from \"socket.io-client\";\r\nimport AceEditor from \"react-ace\";\r\nimport \"ace-builds/src-noconflict/mode-javascript\";\r\nimport \"ace-builds/src-noconflict/theme-monokai\";\r\nimport \"ace-builds/src-noconflict/ext-language_tools\";\r\nimport \"ace-builds/src-noconflict/snippets/javascript\";\r\n\r\nimport Members from '../Members/Members';\r\nimport Notifications from '../Notifications/Notifications';\r\nimport InfoBar from '../InfoBar/InfoBar';\r\n\r\nlet socket;\r\n\r\n\r\nconst Chat = (data) => {\r\n    const [name, setName] = useState('');\r\n    const [room, setRoom] = useState('');\r\n    const [users, setUsers] = useState([]);\r\n    const [notifications, setNotifications] = useState([]);\r\n    const [flag, setFlag]= useState({error: false, msg: ''});\r\n    const [code, setCode] = useState('');\r\n    const [lastedit, setLastEdit] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const ENDPOINT =  'https://may-codeditor3.herokuapp.com/' //'http://localhost:5000/';\r\n\r\n    //Component did mount, destructure data/args from reate and join room component\r\n    //Do socket.io to create and join, accordingly\r\n\r\n    useEffect(() => {\r\n        const {name, room, create} = data;\r\n\r\n        socket = io(ENDPOINT);\r\n\r\n        setRoom(room);\r\n        setName(name);\r\n\r\n        if(create){\r\n            //perform create function specified in socket.io for args user and error\r\n            socket.emit('create', { name, room }, (error) => {\r\n                setLoading(false); \r\n                if(error) {\r\n                    setFlag({...flag, error: true, msg: error});\r\n                }\r\n            });\r\n        }\r\n        \r\n        else{\r\n            socket.emit('join', { name, room }, (error) => {\r\n                setLoading(false);\r\n                if(error) { \r\n                  setFlag({...flag, error: true, msg: error});\r\n                }\r\n            });\r\n        }\r\n        \r\n    }, [ENDPOINT, data]);   //if endpoint is  reloaded, do useEffect \r\n\r\n    //Concatenation; set notification and spread in the array, also add the notification from socket.io \r\n    useEffect(() => {\r\n        socket.on('notification', notification => {\r\n            setNotifications(notifications => [ ...notifications, notification ]);\r\n        });\r\n\r\n        //perform the emit codeMessage from our socket.io, the we are setting code and lastedit\r\n        socket.on('codeMessage', message => {\r\n            setCode(message.text);\r\n            setLastEdit(message.user);\r\n        });\r\n        \r\n        //perform roomData function as in socket.io and destructure data to select only 'users' and set into the users array\r\n        socket.on(\"roomData\", ({users}) => {\r\n            setUsers(users);\r\n        });\r\n    }, []);\r\n\r\n    //responsible for passing change in contents of editor; onChange\r\n    const validateInput = (value) => {\r\n        socket.emit('sendCode', value);\r\n    }\r\n\r\n    if(flag.error == true){\r\n        setTimeout(()=> {\r\n            window.location.href='/';\r\n        }, 1000);\r\n    }\r\n\r\n\r\n\r\n    const editor = () => {\r\n        return (\r\n        <div className=\"container\" >\r\n            <div class=\"row\">\r\n                <div className=\"col\" style={{marginTop: 20}}>\r\n                    <div className=\"card p-3 logincard\" style={{width: '35rem'}}>\r\n                        <InfoBar room={room} lastedit={lastedit} />\r\n                        <AceEditor mode=\"javascript\" theme=\"monokai\" value={code} \r\n                        onChange={(value) => validateInput(value)} //onChange it should do validateInput function(which is to emit sendCode with our aceEditor value)\r\n                        style={{width: '100%'}}\r\n                            setOptions={{\r\n                                enableLiveAutocompletion: true,\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n                <div className=\"col\" style={{marginTop: 20, marginLeft: '100px'}}>\r\n                    <div className=\"card p-3\">\r\n                        <h5 style={{textAlign: 'center'}}>Notifications</h5>\r\n\r\n                        <div className=\"scroll\">\r\n                            <Notifications notifications={notifications} name={name} />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"card p-3\" style={{marginTop: '20px'}}>\r\n                        <h5 style={{textAlign: 'center'}}>Members</h5>\r\n                        <div className=\"scroll\">\r\n                            <Members users={users}/>\r\n                        </div>\r\n                        <br/><br/>\r\n                        <a className=\"btn btn-danger\" href=\"/\">Leave</a>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        );\r\n    };\r\n\r\n    const errorOccured = () => {\r\n        return (\r\n            <div style={{display: 'flex',  justifyContent:'center', alignItems:'center', height: '100vh'}}>\r\n                <div className=\"alert alert-danger\" role=\"alert\" style={{width: '500px', marginTop: '20px'}}>\r\n                    <h4 className=\"alert-heading\">Error!</h4>\r\n                    <p>An error occured, try again.</p>\r\n                    <hr/>\r\n                    <p className=\"mb-0\">{flag.msg}.</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const loadingScreen = () => {\r\n        return (\r\n            <div>\r\n                <h2 style={{textAlign: \"center\", marginTop: '300px'}}>\r\n                    <div className=\"spinner-border\" role=\"status\">\r\n                        <span className=\"visually-hidden\">Loading...</span>\r\n                    </div>\r\n                </h2>\r\n          </div>\r\n        );\r\n    };\r\n\r\n    \r\n    return (\r\n        <>{ loading === true ? loadingScreen() : flag.error === true ? errorOccured() : editor() }</>\r\n    );\r\n};\r\n\r\n\r\nexport default Chat;"]},"metadata":{},"sourceType":"module"}